<view class="page">
  <!-- 顶部说明卡片 -->
  <view class="card card-main">
    <view class="card-header">
      <text class="card-title">来访预约</text>
      <text class="card-subtitle">提前留位，方便安排接待与沟通时间</text>
    </view>

    <!-- 称呼 -->
    <view class="form-item">
      <text class="label">您的称呼</text>
      <input
        class="input"
        placeholder="如：王先生 / 陈总"
        value="{{name}}"
        bindinput="onNameInput"
      />
    </view>

    <!-- 手机号 -->
    <view class="form-item">
      <text class="label">联系方式</text>
      <input
        class="input"
        type="number"
        maxlength="11"
        placeholder="用于微信 / 电话确认来访"
        value="{{mobile}}"
        bindinput="onMobileInput"
      />
    </view>

    <!-- 人数 -->
    <view class="form-item">
      <text class="label">来访人数</text>
      <input
        class="input"
        type="number"
        placeholder="默认为 1 人，可填写 1~10"
        value="{{peopleCount}}"
        bindinput="onPeopleCountInput"
      />
    </view>

    <!-- 日期 + 时间段 -->
    <view class="form-item">
      <text class="label">来访日期</text>
      <picker
        mode="date"
        value="{{visitDate}}"
        start="{{dateStart}}"
        end="{{dateEnd}}"
        bindchange="onDateChange"
      >
        <view class="picker-display">
          <text class="picker-value">
            {{visitDate || '请选择来访日期'}}
          </text>
        </view>
      </picker>
    </view>

    <view class="form-row">
      <view class="form-item half">
        <text class="label">开始时间</text>
        <picker
          mode="time"
          value="{{startTime}}"
          bindchange="onStartTimeChange"
        >
          <view class="picker-display">
            <text class="picker-value">
              {{startTime || '例如 14:00'}}
            </text>
          </view>
        </picker>
      </view>

      <view class="form-item half">
        <text class="label">结束时间</text>
        <picker
          mode="time"
          value="{{endTime}}"
          bindchange="onEndTimeChange"
        >
          <view class="picker-display">
            <text class="picker-value">
              {{endTime || '例如 15:30'}}
            </text>
          </view>
        </picker>
      </view>
    </view>

    <!-- 来访目的 -->
    <view class="form-item">
      <text class="label">来访目的</text>
      <textarea
        class="textarea"
        placeholder="简单写下你想聊的主题：如账户风险体检 / 实战系统讲解 / 合作探讨等"
        value="{{purpose}}"
        bindinput="onPurposeInput"
      />
      <view class="tag-row">
        <view
          class="tag"
          data-text="交流风控体系与交易观"
          bindtap="onQuickPurposeTap"
        >
          交流风控体系
        </view>
        <view
          class="tag"
          data-text="账户体检与风险诊断"
          bindtap="onQuickPurposeTap"
        >
          账户体检
        </view>
        <view
          class="tag"
          data-text="洽谈合作 / 合伙人机会"
          bindtap="onQuickPurposeTap"
        >
          合作洽谈
        </view>
      </view>
    </view>

    <!-- 备注 -->
    <view class="form-item">
      <text class="label">备注（选填）</text>
      <textarea
        class="textarea"
        placeholder="可写下希望重点解决的问题、带来的资料等"
        value="{{remark}}"
        bindinput="onRemarkInput"
      />
      <text class="remark-tip">
        信息只用于安排来访，不会对外泄露。
      </text>
    </view>
  </view>

  <!-- 预约摘要 -->
  <view
    class="card card-summary"
    wx:if="{{visitDate && startTime && endTime}}"
  >
    <text class="summary-title">本次预约摘要</text>
    <text class="summary-line">
      时间：{{visitDate}} {{startTime}} - {{endTime}}
    </text>
    <text class="summary-line">
      人数：{{peopleCount}} 人
    </text>
    <text class="summary-line" wx:if="{{purpose}}">
      目的：{{purpose}}
    </text>
  </view>

  <!-- 底部操作区 -->
  <view class="bottom-actions">
    <button class="btn-secondary" bindtap="goMyList">
      查看我的来访预约
    </button>
    <button
      class="btn-primary"
      bindtap="onSubmit"
      loading="{{submitting}}"
      disabled="{{submitting}}"
    >
      {{submitting ? '提交中...' : '提交来访预约'}}
    </button>
  </view>
</view>
