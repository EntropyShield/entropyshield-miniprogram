<view class="page">

<!-- 卡片 1：我的专属邀请码 -->
<view class="card card-invite">
  <view class="title">熵盾 · 裂变任务</view>
  <view class="subtitle">
    将邀请码发给好友，让 TA 在训练营中填写你的邀请码，你就能获得完整方案次数奖励。
  </view>

  <view class="invite-row">
    <text class="invite-code">
      {{myInviteCode || '邀请码生成中…'}}
    </text>
    <button class="btn-copy" bindtap="onCopyMyInviteCode">
      复制
    </button>
  </view>

  <view class="tips">
    <text>
      每位控局者只有一个专属邀请码。好友首次绑定后，系统会记录邀请关系，后续 D1 / 完成 7 天都会算在你名下。
    </text>
  </view>
</view>

<!-- 卡片 2：绑定好友的邀请码 -->
<view class="card card-bind">
  <view class="section-title">绑定好友邀请码</view>

  <input
    class="input"
    type="text"
    placeholder="输入好友的邀请码（例如 TEST01）"
    placeholder-style="color:#5f6368"
    value="{{bindInviteCodeInput}}"
    bindinput="onInputBindCode"
  />

  <view wx:if="{{hasBoundInviter}}" class="bound-info">
    <text>已绑定邀请人：{{invitedByCode}}</text>
  </view>

  <!-- 未绑定时可以点击“绑定” -->
  <button
    wx:if="{{!hasBoundInviter}}"
    class="btn-primary"
    bindtap="onBindInviteCode"
  >
    绑定
  </button>

  <!-- 已绑定后按钮置灰，仅做提示 -->
  <button
    wx:else
    class="btn-disabled"
    disabled="true"
  >
    已绑定邀请人
  </button>

  <view class="tips">
    <text>
      提示：每个账号只能绑定 1 位邀请人，绑定后无法修改，请谨慎确认。
    </text>
  </view>
</view>

<!-- 卡片 3：我的裂变奖励统计 -->
<view class="card card-reward">
  <view class="section-title">我的裂变奖励</view>

  <view class="reward-summary">
    <text class="reward-times">
      累计获得完整方案 {{rewardStats.total}} 次
    </text>
    <text class="reward-desc">
      {{rewardSummaryText}}
    </text>
  </view>

  <!-- 奖励明细列表 -->
  <scroll-view
    wx:if="{{rewardLogs.length}}"
    scroll-y="true"
    class="reward-list"
  >
    <block wx:for="{{rewardLogs}}" wx:key="id">
      <view class="reward-item">
        <view class="reward-top">
          <text class="reward-title">{{item._title}}</text>
          <text class="reward-tag">+{{item.reward_times}} 次</text>
        </view>
        <view class="reward-bottom">
          <text class="reward-date">{{item._date}}</text>
          <text class="reward-remark">{{item.remark}}</text>
        </view>
      </view>
    </block>
  </scroll-view>

  <!-- 暂无奖励提示 -->
  <view wx:else class="reward-empty">
    <text>
      暂时还没有获得裂变奖励，可以先邀请 1 位好友体验 7 天风控训练营。
    </text>
  </view>
</view>

<!-- 卡片 4：底部操作 -->
<view class="card card-actions">
  <button class="btn-primary" bindtap="goUseCalc">
    立即使用风控计算器
  </button>

  <button class="btn-ghost" bindtap="goHome">
    返回熵盾首页
  </button>
</view>

</view>
